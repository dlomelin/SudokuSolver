import unittest
from SudokuSolver.modules.Sudoku import Sudoku

class TestSudoku(unittest.TestCase):
	def setUp(self):
		pass

	# Tests the xwing solver using a puzzle that requires xwing technique
	def test_solveXwingColPuzzle(self):
		startData = [
			['1', ' ', '9', '7', ' ', ' ', '6', ' ', '2'],
			[' ', '7', ' ', ' ', '6', ' ', ' ', '1', ' '],
			['4', ' ', ' ', ' ', ' ', '9', '5', ' ', ' '],
			['5', ' ', ' ', ' ', ' ', '3', '7', ' ', ' '],
			[' ', '8', '7', ' ', '5', ' ', ' ', '6', ' '],
			[' ', ' ', '1', '8', ' ', ' ', ' ', ' ', '5'],
			[' ', ' ', '3', '9', ' ', ' ', ' ', ' ', '6'],
			[' ', '1', ' ', ' ', '8', ' ', ' ', '9', ' '],
			['7', '9', ' ', ' ', ' ', '4', '2', ' ', ' '],
		]

		solvedData = [
			['1', '5', '9', '7', '3', '8', '6', '4', '2'],
			['3', '7', '2', '4', '6', '5', '8', '1', '9'],
			['4', '6', '8', '1', '2', '9', '5', '7', '3'],
			['5', '2', '4', '6', '9', '3', '7', '8', '1'],
			['9', '8', '7', '2', '5', '1', '3', '6', '4'],
			['6', '3', '1', '8', '4', '7', '9', '2', '5'],
			['8', '4', '3', '9', '7', '2', '1', '5', '6'],
			['2', '1', '5', '3', '8', '6', '4', '9', '7'],
			['7', '9', '6', '5', '1', '4', '2', '3', '8'],
		]

		self.__validateSolver(startData, solvedData)

	# Tests the multiple lines solver using a puzzle that requires multiple lines technique
	def test_solveMultipleLines(self):
		startData = [
			[' ', ' ', '9', ' ', '3', ' ', '6', ' ', ' '],
			[' ', '3', '6', ' ', '1', '4', ' ', '8', '9'],
			['1', ' ', ' ', '8', '6', '9', ' ', '3', '5'],
			[' ', '9', ' ', ' ', ' ', ' ', '8', ' ', ' '],
			[' ', '1', ' ', ' ', ' ', ' ', ' ', '9', ' '],
			[' ', '6', '8', ' ', '9', ' ', '1', '7', ' '],
			['6', ' ', '1', '9', ' ', '3', ' ', ' ', '2'],
			['9', '7', '2', '6', '4', ' ', '3', ' ', ' '],
			[' ', ' ', '3', ' ', '2', ' ', '9', ' ', ' '],
		]

		solvedData = [
			['8', '4', '9', '5', '3', '2', '6', '1', '7'],
			['5', '3', '6', '7', '1', '4', '2', '8', '9'],
			['1', '2', '7', '8', '6', '9', '4', '3', '5'],
			['3', '9', '5', '4', '7', '1', '8', '2', '6'],
			['7', '1', '4', '2', '8', '6', '5', '9', '3'],
			['2', '6', '8', '3', '9', '5', '1', '7', '4'],
			['6', '8', '1', '9', '5', '3', '7', '4', '2'],
			['9', '7', '2', '6', '4', '8', '3', '5', '1'],
			['4', '5', '3', '1', '2', '7', '9', '6', '8'],
		]

		self.__validateSolver(startData, solvedData)

	# Tests the naked sets solver using a puzzle that requires the naked sets technique
	def test_solveReduceNakedSets(self):
		startData = [
			['4', ' ', ' ', '3', ' ', '8', ' ', ' ', '7'],
			[' ', '1', ' ', ' ', '7', '9', ' ', '4', ' '],
			[' ', ' ', ' ', '6', ' ', '4', ' ', ' ', ' '],
			[' ', '3', ' ', ' ', ' ', '7', ' ', '9', ' '],
			['6', '4', '8', '1', '9', '3', '2', '7', '5'],
			[' ', '7', ' ', ' ', ' ', '2', ' ', '1', ' '],
			[' ', ' ', ' ', '9', ' ', '5', ' ', ' ', ' '],
			[' ', '2', ' ', '7', '4', '1', ' ', '3', ' '],
			['1', ' ', ' ', '8', ' ', '6', ' ', ' ', '4'],
		]

		solvedData = [
			['4', '5', '2', '3', '1', '8', '9', '6', '7'],
			['3', '1', '6', '2', '7', '9', '5', '4', '8'],
			['9', '8', '7', '6', '5', '4', '3', '2', '1'],
			['2', '3', '1', '5', '8', '7', '4', '9', '6'],
			['6', '4', '8', '1', '9', '3', '2', '7', '5'],
			['5', '7', '9', '4', '6', '2', '8', '1', '3'],
			['7', '6', '4', '9', '3', '5', '1', '8', '2'],
			['8', '2', '5', '7', '4', '1', '6', '3', '9'],
			['1', '9', '3', '8', '2', '6', '7', '5', '4'],
		]

		self.__validateSolver(startData, solvedData)

	"""
	def test_template(self):
		startData = [
			[' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
			[' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
			[' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
			[' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
			[' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
			[' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
			[' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
			[' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
			[' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
		]

		solvedData = [
		]

		self.__validateSolver(startData, solvedData)
	"""

	# Test that the __eq__ method returns True for the same data sets
	def test_eq(self):
		data1 = [
			['4', '5', '2', '3', '1', '8', '9', '6', '7'],
			['3', '1', '6', '2', '7', '9', '5', '4', '8'],
			['9', '8', '7', '6', '5', '4', '3', '2', '1'],
			['2', '3', '1', '5', '8', '7', '4', '9', '6'],
			['6', '4', '8', '1', '9', '3', '2', '7', '5'],
			['5', '7', '9', '4', '6', '2', '8', '1', '3'],
			['7', '6', '4', '9', '3', '5', '1', '8', '2'],
			['8', '2', '5', '7', '4', '1', '6', '3', '9'],
			['1', '9', '3', '8', '2', '6', '7', '5', '4'],
		]
		sudokuObj1 = Sudoku(data=data1)
		sudokuObj2 = Sudoku(data=data1)

		self.assertEqual(sudokuObj1, sudokuObj2)

	# Test that the __eq__ method does not return True for different data sets
	def test_notEq(self):
		data1 = [
			['4', '5', '2', '3', '1', '8', '9', '6', '7'],
			['3', '1', '6', '2', '7', '9', '5', '4', '8'],
			['9', '8', '7', '6', '5', '4', '3', '2', '1'],
			['2', '3', '1', '5', '8', '7', '4', '9', '6'],
			['6', '4', '8', '1', '9', '3', '2', '7', '5'],
			['5', '7', '9', '4', '6', '2', '8', '1', '3'],
			['7', '6', '4', '9', '3', '5', '1', '8', '2'],
			['8', '2', '5', '7', '4', '1', '6', '3', '9'],
			['1', '9', '3', '8', '2', '6', '7', '5', '4'],
		]
		sudokuObj1 = Sudoku(data=data1)

		data2 = [
			['8', '4', '9', '5', '3', '2', '6', '1', '7'],
			['5', '3', '6', '7', '1', '4', '2', '8', '9'],
			['1', '2', '7', '8', '6', '9', '4', '3', '5'],
			['3', '9', '5', '4', '7', '1', '8', '2', '6'],
			['7', '1', '4', '2', '8', '6', '5', '9', '3'],
			['2', '6', '8', '3', '9', '5', '1', '7', '4'],
			['6', '8', '1', '9', '5', '3', '7', '4', '2'],
			['9', '7', '2', '6', '4', '8', '3', '5', '1'],
			['4', '5', '3', '1', '2', '7', '9', '6', '8'],
		]
		sudokuObj2 = Sudoku(data=data2)

		self.assertNotEqual(sudokuObj1, sudokuObj2)

	# test the output value of the gridValues method
	def test_gridValues(self):
		startData = [
			['4', ' ', ' ', '3', ' ', '8', ' ', ' ', '7'],
			[' ', '1', ' ', ' ', '7', '9', ' ', '4', ' '],
			[' ', ' ', ' ', '6', ' ', '4', ' ', ' ', ' '],
			[' ', '3', ' ', ' ', ' ', '7', ' ', '9', ' '],
			['6', '4', '8', '1', '9', '3', '2', '7', '5'],
			[' ', '7', ' ', ' ', ' ', '2', ' ', '1', ' '],
			[' ', ' ', ' ', '9', ' ', '5', ' ', ' ', ' '],
			[' ', '2', ' ', '7', '4', '1', ' ', '3', ' '],
			['1', ' ', ' ', '8', ' ', '6', ' ', ' ', '4'],
		]
		sudokuObj = Sudoku(data=startData)
		gridDataTest = sudokuObj.gridValues()

		gridData = [
			['4', '.', '.', '3', '.', '8', '.', '.', '7'],
			['.', '1', '.', '.', '7', '9', '.', '4', '.'],
			['.', '.', '.', '6', '.', '4', '.', '.', '.'],
			['.', '3', '.', '.', '.', '7', '.', '9', '.'],
			['6', '4', '8', '1', '9', '3', '2', '7', '5'],
			['.', '7', '.', '.', '.', '2', '.', '1', '.'],
			['.', '.', '.', '9', '.', '5', '.', '.', '.'],
			['.', '2', '.', '7', '4', '1', '.', '3', '.'],
			['1', '.', '.', '8', '.', '6', '.', '.', '4'],
		]

		self.assertEqual(gridData, gridDataTest)

	# Test that the complete method returns True for a complete data set
	def test_complete(self):
		data1 = [
			['4', '5', '2', '3', '1', '8', '9', '6', '7'],
			['3', '1', '6', '2', '7', '9', '5', '4', '8'],
			['9', '8', '7', '6', '5', '4', '3', '2', '1'],
			['2', '3', '1', '5', '8', '7', '4', '9', '6'],
			['6', '4', '8', '1', '9', '3', '2', '7', '5'],
			['5', '7', '9', '4', '6', '2', '8', '1', '3'],
			['7', '6', '4', '9', '3', '5', '1', '8', '2'],
			['8', '2', '5', '7', '4', '1', '6', '3', '9'],
			['1', '9', '3', '8', '2', '6', '7', '5', '4'],
		]
		sudokuObj1 = Sudoku(data=data1)

		self.assertTrue(sudokuObj1.complete())

	def test_getCellValue(self):
		data1 = [
			['4', '5', '2', '3', '1', '8', '9', '6', '7'],
			['3', '1', '6', '2', '7', '9', '5', '4', '8'],
			['9', '8', '7', '6', '5', '4', '3', '2', '1'],
			['2', '3', '1', '5', '8', '7', '4', '9', '6'],
			['6', '4', '8', '1', '9', '3', '2', '7', '5'],
			['5', '7', '9', '4', '6', '2', '8', '1', '3'],
			['7', '6', '4', '9', '3', '5', '1', '8', '2'],
			['8', '2', '5', '7', '4', '1', '6', '3', '9'],
			['1', '9', '3', '8', '2', '6', '7', '5', '4'],
		]
		sudokuObj1 = Sudoku(data=data1)

		self.assertTrue(sudokuObj1.getCellValue(0, 0, 2, 1), 8)
		self.assertTrue(sudokuObj1.getCellValue(2, 0, 0, 2), 4)
		self.assertTrue(sudokuObj1.getCellValue(1, 1, 0, 1), 5)

	###################
	# Private Methods #
	###################

	def __validateSolver(self, startData, solvedData):
		sudokuObj1 = Sudoku(data=startData)
		sudokuObj1.solve()

		sudokuObj2 = Sudoku(data=solvedData)

		self.assertEqual(sudokuObj1, sudokuObj2)


if __name__ == '__main__':
	unittest.main()
